<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Linear Transformation</title>
  <link rel="stylesheet" href="../style.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
</head>
<body>
  <div class="container">
    <!-- Sidebar -->
    <nav class="sidebar">
      <h2>Contrast & Intensity</h2>
      <ul>
        <li><a href="../index.html">Home</a></li>
        <li><a href="brightness.html">Brightness</a></li>
        <li><a href="contrast.html">Contrast</a></li>
        <li><a href="contrast_stretching.html">Contrast Stretching</a></li>
        <li><a href="linear_transformation.html" class="active">Linear Transformations</a></li>
        <li><a href="log_power_transformation.html">Log & Power Law</a></li>
        <li><a href="intensity_slicing.html">Intensity Slicing</a></li>
      </ul>
    </nav>

    <!-- Main Content -->
    <main class="content">
      <h1>Linear Transformations</h1>

      <!-- Theory Section -->
      <section>
        <h2>Theory</h2>
        <p>
          <strong>Linear transformations</strong> are used to geometrically manipulate images by mapping pixel coordinates 
          using linear equations. They preserve straight lines and parallelism while changing positions, orientations, 
          or scales of objects in the image.
        </p>

        <h3>1. Types of Linear Transformations</h3>
        <ul>
          <li><strong>Translation</strong>: Moves the image horizontally or vertically.</li>
          <li><strong>Scaling</strong>: Enlarges or shrinks the image.</li>
          <li><strong>Rotation</strong>: Rotates the image by a specified angle around a point.</li>
          <li><strong>Shearing</strong>: Slants the shape of an image along a specific axis.</li>
        </ul>

        <h3>2. Transformation Matrix</h3>
        <p>
          Linear transformations can be represented using a <strong>2Ã—2 transformation matrix</strong>. For a pixel coordinate 
          <code>(x, y)</code>, the transformed coordinate <code>(x', y')</code> is calculated as:
        </p>
        <pre><code>x' = a*x + b*y
y' = c*x + d*y
        </code></pre>
        <p>
          Here, <code>a, b, c, d</code> are matrix elements defining the type of transformation (rotation, scaling, shearing, etc.).
        </p>

        <h3>3. Applications</h3>
        <ul>
          <li>Image alignment and registration</li>
          <li>Geometric corrections in satellite images</li>
          <li>Object rotation or resizing in computer vision</li>
          <li>Preprocessing images for deep learning models</li>
        </ul>
      </section>

      <!-- Python Code Section -->
      <section>
        <h2>Python Code</h2>
        <pre><code class="language-python">
import cv2
import numpy as np
import matplotlib.pyplot as plt

# Load the image
img = cv2.imread('assets/low_c.jpeg', cv2.IMREAD_COLOR)
rows, cols, _ = img.shape

# Define a custom transformation matrix (example: shearing + rotation)
rotation_matrix = np.array([
    [1, -1],
    [0,  1]
])

# Create a grid of pixel coordinates
x, y = np.meshgrid(np.arange(cols), np.arange(rows))
coords = np.stack([x.ravel(), y.ravel()], axis=1)

# Center coordinates
center = np.array([cols / 2, rows / 2])
coords_centered = coords - center

# Apply linear transformation
transformed_coords = np.dot(coords_centered, rotation_matrix.T) + center

# Keep only valid coordinates
transformed_coords = np.round(transformed_coords).astype(int)
mask = (
    (transformed_coords[:, 0] >= 0) & (transformed_coords[:, 0] < cols) &
    (transformed_coords[:, 1] >= 0) & (transformed_coords[:, 1] < rows)
)
valid_coords = transformed_coords[mask]
original_coords = coords[mask]

# Create transformed image
transformed_img = np.zeros_like(img)
transformed_img[valid_coords[:, 1], valid_coords[:, 0]] = img[original_coords[:, 1], original_coords[:, 0]]

# Display results
plt.subplot(1, 2, 1)
plt.imshow(cv2.cvtColor(img, cv2.COLOR_BGR2RGB))
plt.title("Original")

plt.subplot(1, 2, 2)
plt.imshow(cv2.cvtColor(transformed_img, cv2.COLOR_BGR2RGB))
plt.title("Transformed")

plt.show()
        </code></pre>
      </section>

      <!-- Output Section -->
      <section>
        <h2>Example Output</h2>
        <div class="output-gallery">
          <figure>
            <img src="../assets/linear_transformation.png" alt="Linear Transformation Example" width="450">
            <figcaption>Original vs. Transformed Image using Linear Transformation</figcaption>
          </figure>
        </div>
      </section>
    </main>
  </div>
</body>
</html>
